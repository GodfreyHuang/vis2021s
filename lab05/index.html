<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="utf-8">
    <title>Lab5_d3v3.0</title>
    <!-- <script src="http://d3js.org/d3.v6.min.js" charset="utf-8"></script>-->  <!--v6.5.0 --> 
	<script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script> <!-- v3.0 -->
    <style type="text/css">
    	@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@900&display=swap');
    	div.bar {
    		border: 1px black solid;
    		padding: 5px;
    		margin: 5px 5px 5px 5px;
    		display: inline-block;
    		width: 10px;
    		height: 100px;
    		background-color: mediumvioletred;
    	}

    	body {
    		border: 1px magenta solid;
    		padding: 100px;
            font-family: 'Noto Serif TC', serif;
            font-size: 30pt;
            color:aliceblue;
            background-color: rgb(44, 106, 165);
    	}

        div{
            vertical-align: bottom;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 10px;
            color: yellow;
        }

        svg{
            background-color: rgb(119, 181, 240);
        }
    </style>
</head>
<body>

    lab05
    <script type="text/javascript">
      // Your beautiful D3 code will go here
      var w = 1200;
      var h = 1000;
      var barPadding = 1;
          //var margin = 50;

      var margin = {top:10, bottom:30, left:30, right:10}

      var svg = d3.select("body")
                  .append("svg")
                  .attr("width", w + margin.right + margin.left)
                  .attr("height", h + margin.top + margin.bottom)
                  .append("g")
                  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      /*var rowConverter = function (d) {
          return {
              Date: parseInt(d.組界),
              Amount: parseInt(d.頻率)
          };
      }*/

      d3.csv("data.csv", function (data) {
          //data.forEach(function (d) {
              //d['組界'] = +d['組界'];
          //    d.Date = +d.Date;
          //});

          var xScale = d3.scaleBand().range ([0, w]).padding(0.2);
          var yScale = d3.scaleLinear().range ([h, 0]);

          xScale.domain(data.map(function(d) { return d['組界']; }));
          yScale.domain([0, d3.max(data, function(d) { return d['頻率']; })]);
          //xScale.domain(data.map(function(d) { return d.Date; }));
          //yScale.domain([0, d3.max(data, function(d) { return d.Amount; })]);
          
          svg.selectAll("rect")
             /*.data(data)
             .enter()
             .append("rect")
             .attr("x", function(d){
                 console.log(xScale(d['組界']));
                 return xScale(d['組界']);
             })
             .attr("y", function(d){
                 return h;
             })
             .attr("width", xScale.bandwidth())
             .attr("height", 0)*/
             .data(data)
             .enter()
             .append("rect")
             .attr("x", function(d, i) {
                return i * (w /28);
                //return d['組界'];
                //console.log(d['頻率']);
                //return d['頻率'];  
             })
             .attr("y", function(d){
                 return h - (d['頻率'] * 15);
             })
             //.attr("y", 0)
             .attr("width", 35)
             .attr("height", function(d){
                 //return d['頻率'];
                 return d['頻率'] * 15;
             })
             .attr("fill", function(d) {
                 return "rgb(199, 21, " + Math.round(d['頻率'] * 10) + ")"
             });

          svg.selectAll("text")
             .data(data)
             .enter()
             .append("text")
             .text(function(d){
                 return d['頻率'];
             })
             .attr("x", function(d, i) {
                 return i * (w / 28) + 10;
             })
             .attr("y", function(d) {
                 if(d['頻率'] == 0){
                    return h - (d['頻率'] * 15);
                 }
                 else{
                    return h - (d['頻率'] * 15) + 15;
                 }                     
             })
             .attr("font-family", "sans-serif")
             .attr("font-size", "15px")
             .attr("fill", "white");

          svg.append("g")
             .attr("id", "xaxis")
             .attr("transform", "translate(0, " + h + ")")
             .call(d3.axisBottom(xScale));

          svg.append("g")
             .attr("id", "yaxis")
             .call(d3.axisLeft(yScale));
             /*.call(d3.axisLeft(yScale).tickFormat(function(d){
                 console.log(h - (d['頻率'] * 15));
                 return h - (d['頻率'] * 15);
             }).ticks(10))*/
      });
        
    </script>
</body>
</html>
  